<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard â€“ SmartHelp</title>

  <link rel="stylesheet" href="style.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>

<header>ðŸ“Š Dashboard â€“ EstatÃ­sticas dos Tickets</header>

<div class="container">
  <h2>Tickets por Categoria</h2>
  <canvas id="chartCategorias"></canvas>
</div>

<div class="container">
  <h2>Tickets por Prioridade</h2>
  <canvas id="chartPrioridade"></canvas>
</div>

<div class="container">
  <h2>Tickets por Estado</h2>
  <canvas id="chartEstado"></canvas>
</div>

<script type="module">
  import { firebaseConfig } from "./firebase.js";
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
  import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  async function gerarDashboard() {
    const snap = await getDocs(collection(db, "tickets"));

    let categorias = {};
    let prioridades = {};
    let estados = {};

    snap.forEach(doc => {
      const t = doc.data();

      categorias[t.categoria] = (categorias[t.categoria] || 0) + 1;
      prioridades[t.prioridade] = (prioridades[t.prioridade] || 0) + 1;
      estados[t.estado] = (estados[t.estado] || 0) + 1;
    });

    // Criar grÃ¡ficos
    new Chart(document.getElementById("chartCategorias"), {
      type: "bar",
      data: {
        labels: Object.keys(categorias),
        datasets: [{
          label: "Tickets",
          data: Object.values(categorias),
          backgroundColor: "#38bdf8"
        }]
      }
    });

    new Chart(document.getElementById("chartPrioridade"), {
      type: "pie",
      data: {
        labels: Object.keys(prioridades),
        datasets: [{
          data: Object.values(prioridades),
          backgroundColor: ["#4ade80", "#facc15", "#f87171", "#38bdf8"]
        }]
      }
    });

    new Chart(document.getElementById("chartEstado"), {
      type: "doughnut",
      data: {
        labels: Object.keys(estados),
        datasets: [{
          data: Object.values(estados),
          backgroundColor: ["#f87171", "#facc15", "#4ade80"]
        }]
      }
    });

  }

  gerarDashboard();
</script>

</body>
</html>
